module "org_policy_customRestrictAuthTypes" {
  source      = "terraform-google-modules/org-policy/google"
  constraint  = "customConstraints/customRestrictAuthTypes"
  title       = "Custom Restrict Authentication Types Policy"
  description = "This custom policy aims to mirror the functionality of the predefined 'Restrict authentication types' constraint. When you apply the restrictAuthTypes constraint, requests to access Cloud Storage resources using the restricted authentication type fail, regardless of the validity of the request. You can use the restrictAuthTypes constraint to restrict HMAC keys to meet regulatory requirements or increase the security of your data. The list constraint explicitly denies specific authentication types while permitting all others. To do so, you must list the restricted authentication types in the deniedValues key within the rules of the restrictAuthTypes constraint. An error occurs if you try to list the restricted authentication types in the allowedValues key. You can restrict the following authentication types: SERVICE_ACCOUNT_HMAC_SIGNED_REQUESTS : Restricts requests signed by service account HMAC keys. USER_ACCOUNT_HMAC_SIGNED_REQUESTS : Restricts requests signed by user account HMAC keys. RSA_SIGNED_REQUESTS : Restricts requests signed by RSA keys. in:ALL_HMAC_SIGNED_REQUESTS : Restrict requests signed by any HMAC key. If you need to meet data sovereignty requirements, it's recommended that you restrict all HMAC signed requests. in:ALL_SIGNED_REQUESTS : Restrict requests signed by any HMAC or RSA key. When you enable this constraint, the following occurs: Cloud Storage restricts access for requests that are authenticated with the restricted authentication type. Requests fail with the error 403 Forbidden . Entities that were previously authorized to perform the request receive an error message explaining that the authentication type is disabled. If HMAC keys are restricted: HMAC keys of the restricted type can no longer be created or activated in the resource that the constraint is enforced upon. Requests to create or activate HMAC keys fail with the error 403 Forbidden . Existing HMAC keys remain but are no longer usable. They can be deactivated or deleted, but cannot be reactivated. When using the restrictAuthTypes constraint, be aware of existing resources that depend on HMAC authentication. For example, if you migrated from Amazon Simple Storage Service (Amazon S3), your application likely uses HMAC keys to authenticate requests to Cloud Storage. You can use the Cloud Monitoring metric storage.googleapis.com/authn/authentication_count to track the number of times HMAC keys have been used to authenticate requests."
  expression  = <<CEL
resource.name.startsWith("projects/YOUR_PROJECT_ID")
CEL
}