{
  "display_name": "Public Cloud Storage Bucket Detector",
  "description": "Detects Cloud Storage buckets that are publicly accessible to all users or all authenticated users.",
  "custom_config": {
    "predicate": {
      "expression": "EXISTS(resource.iamPolicy.bindings, binding, EXISTS(binding.members, member, member == 'allUsers' || member == 'allAuthenticatedUsers'))"
    },
    "resource_selector": {
      "resource_types": ["storage.googleapis.com/Bucket"]
    },
    "severity": "HIGH",
    "recommendation": "Review the IAM policy for the bucket and remove 'allUsers' or 'allAuthenticatedUsers' from roles that grant public access. Consider using fine-grained permissions instead."
    }
}